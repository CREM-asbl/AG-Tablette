<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="google" content="notranslate">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>AG-tablette</title>
    <meta name="description" content="Apprenti Géomètre pour tablettes !">

    <!-- See https://goo.gl/OOhYW5 -->
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" type="text/css" href="src/colorpicker/color-picker.min.css">

    <script src="/bower_components/webcomponentsjs/webcomponents-loader.js"></script>

    <link rel="import" href="/src/AG-tablette-app.html">
    <link rel="import" href="/src/settings.html">

    <style type="text/css">
      html, body, ag-tablette-app {
        width: 100%;
        height: 100%;
        margin: 0px;
        padding: 0px;
        overflow-y: hidden;
      }
      #color-picker-popup {
          position:absolute;
          left:35%;
          top:150px;
          padding: 10px;
          border-radius: 10px;
          border: 2px solid gray;
          background-color: #ddd;
          height: 300px;
          width: 265px;
      }
      #color-picker-previous-colors {
          margin-bottom: 15px;
          height: 60px;
          border: 1px solid #aaa;
      }
      #color-picker-previous-colors > .color-picker-previous-color {
          border: 1px solid black;
          border-radius: 3px;
          width: 20px;
          height: 20px;
          float:left;
          margin: 4px;
          cursor: pointer;
      }
      #settings-popup-gray, #divide-popup-gray {
          width: 100%;
          height: 100%;
          background-color: rgba(0,0,0,0.5);
          position:absolute;
          top:0px;
          left:0px;
      }
      #settings-popup {
          position:absolute;
          left:2%;
          top:2%;
          padding: 20px;
          border-radius: 10px;
          border: 2px solid gray;
          background-color: #ddd;
          height: 90%;
          width: 90%;
          overflow-y: auto;
      }
      #divide-popup {
          position:absolute;
          left:35%;
          top:35%;
          padding: 20px;
          border-radius: 10px;
          border: 2px solid gray;
          background-color: #ddd;
          width: 30%;
          overflow-y: auto;
          text-align: center;
      }
      #settings-popup-close, #divide-popup-close {
          position: relative;
          font-size: 60px;
          float: right;
          cursor: pointer;
          color: #555;
          box-sizing: content-box;
          width: 30px;
          height: 30px;
          overflow: hidden;
          line-height: 40%;
          -webkit-user-select: none;
          -khtml-user-select: none;
          -moz-user-select: none;
          -o-user-select: none;
          user-select: none;
      }
    </style>
  </head>
  <body>
    <script src="src/colorpicker/color-picker.min.js"></script>
    <script src="src/js/App.js"></script>
    <script src="src/js/Canvas.js"></script>
    <script src="src/js/Family.js"></script>
    <script src="src/js/Shape.js"></script>
    <script src="src/js/Point.js"></script>
    <script src="src/js/ShapeStep.js"></script>
    <script src="src/js/Workspace.js"></script>
    <script src="src/js/ColorPicker.js"></script>
    <script src="src/js/Settings.js"></script>
    <script src="src/js/AppHistory.js"></script>
    <script src="src/js/Storer.js"></script>

    <script src="src/js/States/State.js"></script>
    <script src="src/js/States/Create.js"></script>
    <script src="src/js/States/Move.js"></script>
    <script src="src/js/States/Rotate.js"></script>
    <script src="src/js/States/GlobalZoom.js"></script>
    <script src="src/js/States/Delete.js"></script>
    <script src="src/js/States/BackgroundColor.js"></script>
    <script src="src/js/States/BorderColor.js"></script>
    <script src="src/js/States/Linker.js"></script>
    <script src="src/js/States/Unlinker.js"></script>
    <script src="src/js/States/Reverse.js"></script>
    <script src="src/js/States/BuildCenter.js"></script>
    <script src="src/js/States/Duplicate.js"></script>
    <script src="src/js/States/Divide.js"></script>
    <script src="src/js/States/Merge.js"></script>
    <script src="src/js/States/Cut.js"></script>
    <script src="src/js/States/MovePlane.js"></script>

    <ag-tablette-app></ag-tablette-app>

    <div id="color-picker-popup" style="display:none">
        <div>Couleurs précédentes:</div>
        <div id="color-picker-previous-colors">
            <div class="color-picker-previous-color" style="background-color:#eee"></div>
            <div class="color-picker-previous-color" style="background-color:#aaa"></div>
            <div class="color-picker-previous-color" style="background-color:#ccc"></div>
            <div class="color-picker-previous-color" style="background-color:#555"></div>
        </div>
        <div>Choisir une couleur:</div>
        <input id="color-picker-input" type="text" />
        <button type="button" id="color-picker-input-ok" onclick='window.app.colorpicker.__validate()'>Valider</button>
    </div>

    <div id="settings-popup-gray" style="display:none">
        <div id="settings-popup">
            <div id="settings-popup-close" onclick="document.getElementById('settings-popup-gray').style.display='none';">&times;</div>
            <app-settings></app-settings>
        </div>
    </div>

    <div id="divide-popup-gray" style="display:none">
        <div id="divide-popup">
            <div id="divide-popup-close" onclick="document.getElementById('divide-popup-gray').style.display='none';">&times;</div>

            <label for="settings_divide_number_of_parts">Découpage en </label>
            <input type="number" max="10" min="2" step="1" value="2" name="settings_divide_number_of_parts" id="settings_divide_number_of_parts" on-change='_numOfParts' style='font-size:20px;'>
            <span> parties</span>
            <br><br>
            <button onclick="dividePopupValidate()">Valider</button>
        </div>
    </div>


    <script>
      function dividePopupValidate(){
          document.getElementById('divide-popup-gray').style.display='none';
          var val = document.getElementById('settings_divide_number_of_parts').value;

          if(val > 10)
              val = 10;
          if(val < 2)
              val = 2;
          val = parseInt(val);
          window.app.state.nb_parts = val;
      }
      var canvasDiv = document.getElementsByTagName("ag-tablette-app")[0].shadowRoot.getElementById("div-main-canvas");
      var canvasLeftShift = document.getElementsByTagName("ag-tablette-app")[0].shadowRoot.getElementById("app-canvas-view-toolbar").clientWidth;
      //var canvasTopShift = 0;
      var canvas = canvasDiv.shadowRoot.getElementById("mainCanvas");
      var backgroundCanvas = canvasDiv.shadowRoot.getElementById("backgroundCanvas");
      var app = new App(canvasDiv, canvas, backgroundCanvas);
      app.start();
    </script>
  </body>
</html>
